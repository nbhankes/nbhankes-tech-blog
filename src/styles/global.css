@import "tailwindcss";

@plugin "@tailwindcss/typography";

@custom-variant dark (&:where(.dark, .dark *));

/* Tailwind doesn't fully support some of the complex CSS selectors needed for code highlighting,
so we need to keep some custom CSS but applied through Tailwind's plugin system
These styles are for code highlighting that can't be easily implemented with just Tailwind */
@layer utilities {
    .content pre {
        @apply p-0;
    }

    .content code {
        @apply overflow-x-auto;
    }

    .content [data-rehype-pretty-code-figure] code {
        @apply p-0;
    }

    .content pre > code span[data-line] {
        @apply border-l-8 border-transparent px-2;
    }

    .content pre > code span:first-of-type {
        @apply rounded-t-lg pt-2;
    }

    .content pre > code span:last-of-type {
        @apply rounded-b-lg pb-2;
    }

    .content pre > code .highlighted {
        @apply border-l-8 !border-gray-300/60 bg-gray-200/5;
    }

    .content pre > code[data-line-numbers] {
        counter-reset: line;
    }

    .content pre > code[data-line-numbers] > span[data-line]::before {
        counter-increment: line;
        content: counter(line);
        @apply mr-8 inline-block w-4 text-left text-[#7ca2dfad];
    }

    .content pre > code > span[data-line]::before {
        content: '';
        @apply inline-block w-4 text-right;
    }

    .content pre > code[data-line-numbers-max-digits='2'] > span[data-line]::before {
        @apply w-8;
    }

    .content code[data-line-numbers-max-digits='3'] > span[data-line]::before {
        @apply w-12;
    }

    /* Make pretty-code blocks wrap instead of scroll */
    [data-rehype-pretty-code-figure] pre {
    white-space: pre-wrap !important;   /* allow wrapping */
    overflow-x: visible;                 /* no horizontal scrollbar */
    }

    /* Inherit wrapping into the code grid and its line spans */
    [data-rehype-pretty-code-figure] code {
    display: block;                      /* break out of grid; optional but safest */
    white-space: inherit !important;
    min-width: 0;                        /* allow shrinking/wrapping */
    }

    [data-rehype-pretty-code-figure] code > span[data-line] {
    display: block;
    white-space: inherit !important;
    overflow-wrap: anywhere;             /* strong wrap hint for long tokens/URLs */
    word-break: break-word;
    min-width: 0;
    }

    /* (Optional) If your theme forces grid on <code>, keep it but allow wrapping */
    [data-rehype-pretty-code-figure] code[style*="display: grid"] {
    display: grid;
    white-space: inherit !important;
    min-width: 0;
    }
}